import streamlit as st

st.set_page_config(page_title="Квиз-калькулятор A25", page_icon="✨", layout="centered")

st.title("Квиз-калькулятор A25 Studio")
st.write("Ответьте на вопросы, и мы подберем для вас подходящий тариф и рассчитаем стоимость.")

# --- Ввод ---
area = st.number_input("Площадь объекта (м²)", min_value=10, max_value=1000, step=1, value=50)

location = st.radio("Где находится объект?", ["Санкт-Петербург / Ленобласть", "За пределами ЛО"])
obj_type = st.selectbox("Что проектируем?", [
    "Маленькая квартира / студия",
    "Квартира средней сложности",
    "Большая квартира / дом",
    "Коммерческое помещение"
])
visualization = st.radio("Какая визуализация нужна?", [
    "Только 2D-коллажи (3 правки)",
    "3D-визуализация (до 3 правок)",
    "3D-визуализация (неограниченные правки)"
])
author_supervision = st.radio("Авторский надзор и выезды", [
    "Нет, только дистанционно",
    "Разовый выезд",
    "Авторский надзор (регулярно)",
    "Расширенное сопровождение"
])
complect = st.radio("Комплектация объекта", [
    "Нет / только помощь",
    "Частичная комплектация",
    "Полная комплектация (заказы, приемка)"
])
acceptance = st.checkbox("Приемка товара (900 руб/м²)")
extra_exit = st.checkbox("Доп. выезд (2900 руб)")

budget_level = st.radio("Бюджет на проект", [
    "Низкий (≤2750 руб/м²)",
    "Средний (2751–4750 руб/м²)",
    "Высокий (≥4751 руб/м²)"
])
urgency = st.radio("Сроки выполнения", [
    "Больше 6 месяцев",
    "2–6 месяцев",
    "До 2 месяцев (срочно)"
])
wishes = st.multiselect("Доп. пожелания", ["360°-тур", "Видеонаблюдение", "Скидки на материалы", "Рассрочка"])

# --- Подсчёт ---
scores = {
    "location": 0 if location == "Санкт-Петербург / Ленобласть" else 1,
    "obj": {"Маленькая квартира / студия": 1, "Квартира средней сложности": 3,
            "Большая квартира / дом": 5, "Коммерческое помещение": 8}[obj_type],
    "visualization": {"Только 2D-коллажи (3 правки)": 1,
                      "3D-визуализация (до 3 правок)": 5,
                      "3D-визуализация (неограниченные правки)": 12}[visualization],
    "author": {"Нет, только дистанционно": 0,
               "Разовый выезд": 1,
               "Авторский надзор (регулярно)": 4,
               "Расширенное сопровождение": 6}[author_supervision],
    "complect": {"Нет / только помощь": 0,
                 "Частичная комплектация": 3,
                 "Полная комплектация (заказы, приемка)": 12}[complect],
    "budget": {"Низкий (≤2750 руб/м²)": 1,
               "Средний (2751–4750 руб/м²)": 4,
               "Высокий (≥4751 руб/м²)": 7}[budget_level],
    "urgency": {"Больше 6 месяцев": 0,
                "2–6 месяцев": 1,
                "До 2 месяцев (срочно)": 3}[urgency],
    "wishes": len(wishes)
}
score = sum(scores.values())

price_std = area * 2500
price_opt = area * 3500
price_max = area * 6000
if acceptance:
    price_std += area * 900
    price_opt += area * 900
    price_max += area * 900
if extra_exit:
    price_std += 2900
    price_opt += 2900
    price_max += 2900

# Сроки
if area <= 50:
    timeline = "2–2.5 месяца"
elif area <= 120:
    timeline = "2.5–3.5 месяца"
else:
    timeline = "от 3.5 месяцев"

# Логика выбора тарифа
if complect == "Полная комплектация (заказы, приемка)" or visualization == "3D-визуализация (неограниченные правки)":
    tariff, price = "Максимальный", price_max
elif score >= 25:
    tariff, price = "Максимальный", price_max
elif score >= 10:
    tariff, price = "Оптимальный", price_opt
else:
    tariff, price = "Стандартный", price_std

# --- Результат ---
st.subheader("Ваш результат:")
st.markdown(f"""
Рекомендованный тариф: {tariff}
Стоимость: {price:,.0f} руб
Сроки: {timeline}
Score (внутренний показатель): {score}
""")
